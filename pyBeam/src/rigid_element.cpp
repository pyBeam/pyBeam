/*
 * pyBeam, an open-source Beam Solver
 *
 * Copyright (C) 2019 by the authors
 *
 * File developers: Rocco Bombardieri (Carlos III University Madrid)
 *                  Rauno Cavallaro (Carlos III University Madrid)
 *
 * This file is part of pyBeam.
 *
 * pyBeam is free software: you can redistribute it and/or
 * modify it under the terms of the GNU Affero General Public License
 * as published by the Free Software Foundation, either version 3 of the
 * License, or (at your option) any later version.
 *
 * pyBeam is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty
 * of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
 *
 * See the GNU Affero General Public License for more details.
 * You should have received a copy of the GNU Affero
 * General Public License along with pyBeam.
 * If not, see <http://www.gnu.org/licenses/>.
 *
 */


#include "../include/rigid_element.h"
#include <iostream>

CRBE2::CRBE2(int RBE2_ID) {
    iRBE2 = RBE2_ID;
};

void CRBE2::setGlobalDOFs() {

    int nodeIndexM = node_master-> GeID();
    int nodeIndexS = node_slave-> GeID();
    int i = 0;
    for (int i = 1; i <= 6; i++) {
        // This coefficients will be used to asseble full_to_red and red_to_full vectors which have 0 expressing no relation so it is decided that DOFs will be from 1 to 6
        MasterDOFs(i - 1) = (nodeIndexM - 1)*6 + i; // -1;
        SlaveDOFs(i - 1) = (nodeIndexS - 1)*6 + i; // -1;
    };

};

void CRBE2::setLength() {
    addouble a = node_slave->GetCoordinate0(0) - node_master->GetCoordinate0(0);
    addouble b = node_slave->GetCoordinate0(1) - node_master->GetCoordinate0(1);
    addouble c = node_slave->GetCoordinate0(2) - node_master->GetCoordinate0(2);
    addouble intermediate = pow(a, 2) + pow(b, 2) + pow(c, 2);
    l_rigid = sqrt(intermediate);

};

void CRBE2::InitializeAxisVector() {

    addouble a = node_slave->GetCoordinate0(0) - node_master->GetCoordinate0(0);
    addouble b = node_slave->GetCoordinate0(1) - node_master->GetCoordinate0(1);
    addouble c = node_slave->GetCoordinate0(2) - node_master->GetCoordinate0(2);

    axis_vector0 = VectorXdDiff::Zero(3);
    axis_vector0(0) = a;
    axis_vector0(1) = b;
    axis_vector0(2) = c;


    axis_vector_old = axis_vector0;
    axis_vector = axis_vector0;
}

void CRBE2::InitializeKinemMatrix() {

    Kinem_matrix = MatrixXdDiff::Identity(6, 6);
    MStrans = MatrixXdDiff::Zero(3, 3);

    /*        Kprim = [        0         axis_vector(3)   -axis_vector(2);
     -axis_vector(3)        0           axis_vector(1);
     axis_vector(2) -axis_vector(1)        0            ];*/

    MStrans << 0, axis_vector0(3 - 1), -axis_vector0(2 - 1),
            -axis_vector0(3 - 1), 0, axis_vector0(1 - 1),
            axis_vector0(2 - 1), -axis_vector0(1 - 1), 0;


    MStrans0 = MStrans;
    MStrans_old = MStrans;

    Kinem_matrix.block(1 - 1, 4 - 1, 3, 3) = MStrans;
    Kinem_matrix0 = Kinem_matrix;
    Kinem_matrix_old = Kinem_matrix;
    //std::cout << "  Kinem_matrix = \n" << Kinem_matrix << std::endl;
}

void CRBE2::UpdateKinemMatirx() {

    MStrans_old = MStrans;

    Kinem_matrix_old = Kinem_matrix;

    Kinem_matrix = MatrixXdDiff::Identity(6, 6);
    MatrixXdDiff MStrans = MatrixXdDiff::Zero(3, 3);

    MStrans << 0, axis_vector(3 - 1), -axis_vector(2 - 1),
            -axis_vector(3 - 1), 0, axis_vector(1 - 1),
            axis_vector(2 - 1), -axis_vector(1 - 1), 0;

    Kinem_matrix.block(1 - 1, 4 - 1, 3, 3) = MStrans;
    //std::cout << "  Kinem_matrix = \n" << Kinem_matrix << std::endl;

}

void CRBE2::Initializer(CNode* Node_mast, CNode* Node_slv) {

    // Associate the nodes object
    SetNode_1(Node_mast);
    SetNode_2(Node_slv);
    // Calculate element DOFs
    setGlobalDOFs();
    // set rigid element length
    setLength();
    // Initialize dimensional axis vector
    InitializeAxisVector();


    InitializeKinemMatrix();


}

void CRBE2::EvalConstraintEquation(VectorXdDiff Um, VectorXdDiff Us) {
    
    addouble Dx = axis_vector(0); addouble Dy = axis_vector(1); addouble Dz = axis_vector(2);
    addouble Umtx = Um(1-1); addouble Umty = Um(2-1); addouble Umtz = Um(3-1);
    addouble Umrx = Um(4-1); addouble Umry = Um(5-1); addouble Umrz = Um(6-1);
    addouble Ustx = Us(1-1); addouble Usty = Us(2-1); addouble Ustz = Us(3-1);
    addouble Usrx = Us(4-1); addouble Usry = Us(5-1); addouble Usrz = Us(6-1);
    //U_M_rot = Um.segment(4-1,3);      // Rotation at triad A
        
    g = VectorXdDiff::Zero(6);
    //VectorXdDiff gb = VectorXdDiff::Zero(6);   
     if (abs(Umrx) < 1.0e-19 and abs(Umry) < 1.0e-19 and abs(Umrz) < 1.0e-19 ) {Umrx = 1.0e-19; };  //to avoid singularities 
    //if (abs(Umry) < 1.0e-19 ) {Umry = 1.0e-19; };  //to avoid singularities 
    //if (abs(Umrz) < 1.0e-19 ) {Umrz = 1.0e-19; };  //to avoid singularities
    
    g(0) = -Umtx+Ustx+Dy*(Umrz*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz)+(Umrx*Umry*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0))/(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-Dz*(Umry*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz)-(Umrx*Umrz*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0))/(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-(Dx*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*(Umry*Umry+Umrz*Umrz))/(Umrx*Umrx+Umry*Umry+Umrz*Umrz);
    g(1) = -Umty+Usty-Dx*(Umrz*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz)-(Umrx*Umry*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0))/(Umrx*Umrx+Umry*Umry+Umrz*Umrz))+Dz*(Umrx*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz)+(Umry*Umrz*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0))/(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-(Dy*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*(Umrx*Umrx+Umrz*Umrz))/(Umrx*Umrx+Umry*Umry+Umrz*Umrz);
    g(2) = -Umtz+Ustz+Dx*(Umry*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz)+(Umrx*Umrz*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0))/(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-Dy*(Umrx*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz)-(Umry*Umrz*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0))/(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-(Dz*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*(Umrx*Umrx+Umry*Umry))/(Umrx*Umrx+Umry*Umry+Umrz*Umrz);
    g(3) = -Umrx+Usrx;
    g(4) = -Umry+Usry;
    g(5) = -Umrz+Usrz;    
    
    
}
void CRBE2::EvalJacobian(VectorXdDiff Um ) {
    //std::cout << "\nSymbolic\n" << std::endl;
    // G
    G = MatrixXdDiff::Zero(6,12);       // Jacobian of the constraint equations on LHS   
    addouble Dx = axis_vector(0); addouble Dy = axis_vector(1); addouble Dz = axis_vector(2);
    //addouble Umtx = Um(1-1); addouble Umty = Um(2-1); addouble Umtz = Um(3-1);
    addouble Umrx = Um(4-1); addouble Umry = Um(5-1); addouble Umrz = Um(6-1);

    if (abs(Umrx) < 1.0e-19 and abs(Umry) < 1.0e-19 and abs(Umrz) < 1.0e-19 ) {Umrz = 1.0e-19; };  //to avoid singularities 
    //if (abs(Umry) < 1.0e-19 ) {Umry = 1.0e-19; };  //to avoid singularities 
    //if (abs(Umrz) < 1.0e-19 ) {Umrz = 1.0e-19; };  //to avoid singularities  
    //std::cout << "Um_rot = " <<setprecision(20)<< Umrx <<" " << Umry <<" " << Umrz << "\n" << std::endl; 

    G(0,0) = -1.0;
    G(0,3) = -Dy*(-(Umry*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0))/(Umrx*Umrx+Umry*Umry+Umrz*Umrz)-(Umrx*Umrz*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz)))/(Umrx*Umrx+Umry*Umry+Umrz*Umrz)+Umrx*Umrz*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)+(Umrx*Umrx)*Umry*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)+(Umrx*Umrx)*Umry*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)*2.0)-Dz*(-(Umrz*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0))/(Umrx*Umrx+Umry*Umry+Umrz*Umrz)+(Umrx*Umry*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz)))/(Umrx*Umrx+Umry*Umry+Umrz*Umrz)-Umrx*Umry*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)+(Umrx*Umrx)*Umrz*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)+(Umrx*Umrx)*Umrz*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)*2.0)+Dx*Umrx*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*(Umry*Umry+Umrz*Umrz)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)*2.0+Dx*Umrx*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*(Umry*Umry+Umrz*Umrz)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0);
    G(0,4) = -Dy*(-(Umrx*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0))/(Umrx*Umrx+Umry*Umry+Umrz*Umrz)-(Umry*Umrz*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz)))/(Umrx*Umrx+Umry*Umry+Umrz*Umrz)+Umry*Umrz*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)+Umrx*(Umry*Umry)*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)+Umrx*(Umry*Umry)*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)*2.0)-Dz*(sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz)+((Umry*Umry)*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz)))/(Umrx*Umrx+Umry*Umry+Umrz*Umrz)-(Umry*Umry)*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)+Umrx*Umry*Umrz*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)+Umrx*Umry*Umrz*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)*2.0)-(Dx*Umry*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*2.0)/(Umrx*Umrx+Umry*Umry+Umrz*Umrz)+Dx*Umry*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*(Umry*Umry+Umrz*Umrz)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)*2.0+Dx*Umry*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*(Umry*Umry+Umrz*Umrz)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0);
    G(0,5) = -Dz*(-(Umrx*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0))/(Umrx*Umrx+Umry*Umry+Umrz*Umrz)+(Umry*Umrz*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz)))/(Umrx*Umrx+Umry*Umry+Umrz*Umrz)-Umry*Umrz*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)+Umrx*(Umrz*Umrz)*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)+Umrx*(Umrz*Umrz)*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)*2.0)-Dy*(-sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz)-((Umrz*Umrz)*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz)))/(Umrx*Umrx+Umry*Umry+Umrz*Umrz)+(Umrz*Umrz)*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)+Umrx*Umry*Umrz*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)+Umrx*Umry*Umrz*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)*2.0)-(Dx*Umrz*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*2.0)/(Umrx*Umrx+Umry*Umry+Umrz*Umrz)+Dx*Umrz*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*(Umry*Umry+Umrz*Umrz)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)*2.0+Dx*Umrz*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*(Umry*Umry+Umrz*Umrz)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0);
    G(0,6) = 1.0;
    G(1,1) = -1.0;
    G(1,3) = -Dx*(-(Umry*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0))/(Umrx*Umrx+Umry*Umry+Umrz*Umrz)+(Umrx*Umrz*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz)))/(Umrx*Umrx+Umry*Umry+Umrz*Umrz)-Umrx*Umrz*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)+(Umrx*Umrx)*Umry*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)+(Umrx*Umrx)*Umry*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)*2.0)-Dz*(-sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz)-((Umrx*Umrx)*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz)))/(Umrx*Umrx+Umry*Umry+Umrz*Umrz)+(Umrx*Umrx)*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)+Umrx*Umry*Umrz*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)+Umrx*Umry*Umrz*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)*2.0)-(Dy*Umrx*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*2.0)/(Umrx*Umrx+Umry*Umry+Umrz*Umrz)+Dy*Umrx*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*(Umrx*Umrx+Umrz*Umrz)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)*2.0+Dy*Umrx*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*(Umrx*Umrx+Umrz*Umrz)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0);
    G(1,4) = -Dx*(-(Umrx*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0))/(Umrx*Umrx+Umry*Umry+Umrz*Umrz)+(Umry*Umrz*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz)))/(Umrx*Umrx+Umry*Umry+Umrz*Umrz)-Umry*Umrz*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)+Umrx*(Umry*Umry)*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)+Umrx*(Umry*Umry)*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)*2.0)-Dz*(-(Umrz*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0))/(Umrx*Umrx+Umry*Umry+Umrz*Umrz)-(Umrx*Umry*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz)))/(Umrx*Umrx+Umry*Umry+Umrz*Umrz)+Umrx*Umry*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)+(Umry*Umry)*Umrz*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)+(Umry*Umry)*Umrz*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)*2.0)+Dy*Umry*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*(Umrx*Umrx+Umrz*Umrz)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)*2.0+Dy*Umry*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*(Umrx*Umrx+Umrz*Umrz)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0);
    G(1,5) = -Dz*(-(Umry*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0))/(Umrx*Umrx+Umry*Umry+Umrz*Umrz)-(Umrx*Umrz*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz)))/(Umrx*Umrx+Umry*Umry+Umrz*Umrz)+Umrx*Umrz*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)+Umry*(Umrz*Umrz)*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)+Umry*(Umrz*Umrz)*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)*2.0)-Dx*(sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz)+((Umrz*Umrz)*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz)))/(Umrx*Umrx+Umry*Umry+Umrz*Umrz)-(Umrz*Umrz)*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)+Umrx*Umry*Umrz*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)+Umrx*Umry*Umrz*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)*2.0)-(Dy*Umrz*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*2.0)/(Umrx*Umrx+Umry*Umry+Umrz*Umrz)+Dy*Umrz*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*(Umrx*Umrx+Umrz*Umrz)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)*2.0+Dy*Umrz*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*(Umrx*Umrx+Umrz*Umrz)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0);
    G(1,7) = 1.0;
    G(2,2) = -1.0;
    G(2,3) = -Dx*(-(Umrz*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0))/(Umrx*Umrx+Umry*Umry+Umrz*Umrz)-(Umrx*Umry*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz)))/(Umrx*Umrx+Umry*Umry+Umrz*Umrz)+Umrx*Umry*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)+(Umrx*Umrx)*Umrz*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)+(Umrx*Umrx)*Umrz*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)*2.0)-Dy*(sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz)+((Umrx*Umrx)*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz)))/(Umrx*Umrx+Umry*Umry+Umrz*Umrz)-(Umrx*Umrx)*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)+Umrx*Umry*Umrz*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)+Umrx*Umry*Umrz*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)*2.0)-(Dz*Umrx*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*2.0)/(Umrx*Umrx+Umry*Umry+Umrz*Umrz)+Dz*Umrx*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*(Umrx*Umrx+Umry*Umry)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)*2.0+Dz*Umrx*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*(Umrx*Umrx+Umry*Umry)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0);
    G(2,4) = -Dy*(-(Umrz*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0))/(Umrx*Umrx+Umry*Umry+Umrz*Umrz)+(Umrx*Umry*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz)))/(Umrx*Umrx+Umry*Umry+Umrz*Umrz)-Umrx*Umry*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)+(Umry*Umry)*Umrz*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)+(Umry*Umry)*Umrz*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)*2.0)-Dx*(-sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz)-((Umry*Umry)*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz)))/(Umrx*Umrx+Umry*Umry+Umrz*Umrz)+(Umry*Umry)*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)+Umrx*Umry*Umrz*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)+Umrx*Umry*Umrz*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)*2.0)-(Dz*Umry*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*2.0)/(Umrx*Umrx+Umry*Umry+Umrz*Umrz)+Dz*Umry*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*(Umrx*Umrx+Umry*Umry)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)*2.0+Dz*Umry*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*(Umrx*Umrx+Umry*Umry)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0);
    G(2,5) = -Dx*(-(Umrx*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0))/(Umrx*Umrx+Umry*Umry+Umrz*Umrz)-(Umry*Umrz*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz)))/(Umrx*Umrx+Umry*Umry+Umrz*Umrz)+Umry*Umrz*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)+Umrx*(Umrz*Umrz)*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)+Umrx*(Umrz*Umrz)*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)*2.0)-Dy*(-(Umry*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0))/(Umrx*Umrx+Umry*Umry+Umrz*Umrz)+(Umrx*Umrz*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz)))/(Umrx*Umrx+Umry*Umry+Umrz*Umrz)-Umrx*Umrz*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)+Umry*(Umrz*Umrz)*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)+Umry*(Umrz*Umrz)*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)*2.0)+Dz*Umrz*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*(Umrx*Umrx+Umry*Umry)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)*2.0+Dz*Umrz*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*(Umrx*Umrx+Umry*Umry)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0);
    G(2,8) = 1.0;
    G(3,3) = -1.0;
    G(3,9) = 1.0;
    G(4,4) = -1.0;
    G(4,10) = 1.0;
    G(5,5) = -1.0;
    G(5,11) = 1.0;    
      
}

void CRBE2::EvalHessian(VectorXdDiff Um){
 
    // H_0
    H_0 = MatrixXdDiff::Zero(12,12);
    H_1 = MatrixXdDiff::Zero(12,12);
    H_2 = MatrixXdDiff::Zero(12,12);
    addouble Dx = axis_vector(0); addouble Dy = axis_vector(1); addouble Dz = axis_vector(2);
    addouble Umtx = Um(1-1); addouble Umty = Um(2-1); addouble Umtz = Um(3-1);
    addouble Umrx = Um(4-1); addouble Umry = Um(5-1); addouble Umrz = Um(6-1);
    
     if (abs(Umrx) < 1.0e-19 and abs(Umry) < 1.0e-19 and abs(Umrz) < 1.0e-19 ) {Umrx = 1.0e-19; };  //to avoid singularities 
    //if (abs(Umry) < 1.0e-19 ) {Umry = 1.0e-19; };  //to avoid singularities 
    //if (abs(Umrz) < 1.0e-19 ) {Umrz = 1.0e-19; };  //to avoid singularities
    
    H_0(3,3) = -Dy*(-(Umrz*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz)))/(Umrx*Umrx+Umry*Umry+Umrz*Umrz)+Umrz*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)+Umrx*Umry*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)*3.0+Umrx*Umry*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)*6.0+(Umrx*Umrx)*Umrz*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)*3.0+(Umrx*Umrx*Umrx)*Umry*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)+(Umrx*Umrx)*Umrz*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)-(Umrx*Umrx)*Umrz*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,5.0/2.0)*3.0-(Umrx*Umrx*Umrx)*Umry*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,5.0/2.0)*5.0-(Umrx*Umrx*Umrx)*Umry*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0)*8.0)-Dz*((Umry*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz)))/(Umrx*Umrx+Umry*Umry+Umrz*Umrz)-Umry*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)+Umrx*Umrz*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)*3.0+Umrx*Umrz*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)*6.0-(Umrx*Umrx)*Umry*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)*3.0+(Umrx*Umrx*Umrx)*Umrz*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)-(Umrx*Umrx)*Umry*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)+(Umrx*Umrx)*Umry*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,5.0/2.0)*3.0-(Umrx*Umrx*Umrx)*Umrz*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,5.0/2.0)*5.0-(Umrx*Umrx*Umrx)*Umrz*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0)*8.0)+Dx*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*(Umry*Umry+Umrz*Umrz)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)+Dx*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*(Umry*Umry+Umrz*Umrz)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)*2.0+Dx*(Umrx*Umrx)*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*(Umry*Umry+Umrz*Umrz)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)-Dx*(Umrx*Umrx)*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*(Umry*Umry+Umrz*Umrz)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,5.0/2.0)*5.0-Dx*(Umrx*Umrx)*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*(Umry*Umry+Umrz*Umrz)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0)*8.0;
    H_0(3,4) = -Dz*((Umrx*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz)))/(Umrx*Umrx+Umry*Umry+Umrz*Umrz)-Umrx*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)+Umry*Umrz*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)+Umry*Umrz*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)*2.0-Umrx*(Umry*Umry)*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)*3.0-Umrx*(Umry*Umry)*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)+Umrx*(Umry*Umry)*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,5.0/2.0)*3.0-(Umrx*Umrx)*Umry*Umrz*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0)*8.0+(Umrx*Umrx)*Umry*Umrz*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)-(Umrx*Umrx)*Umry*Umrz*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,5.0/2.0)*5.0)-Dy*(-(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)/(Umrx*Umrx+Umry*Umry+Umrz*Umrz)+(Umrx*Umrx)*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)+(Umry*Umry)*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)+(Umrx*Umrx)*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)*2.0+(Umry*Umry)*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)*2.0-(Umrx*Umrx)*(Umry*Umry)*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0)*8.0+(Umrx*Umrx)*(Umry*Umry)*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)-(Umrx*Umrx)*(Umry*Umry)*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,5.0/2.0)*5.0+Umrx*Umry*Umrz*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)*3.0+Umrx*Umry*Umrz*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)-Umrx*Umry*Umrz*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,5.0/2.0)*3.0)+Dx*Umrx*Umry*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)*2.0+Dx*Umrx*Umry*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)*4.0+Dx*Umrx*Umry*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*(Umry*Umry+Umrz*Umrz)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)-Dx*Umrx*Umry*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*(Umry*Umry+Umrz*Umrz)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,5.0/2.0)*5.0-Dx*Umrx*Umry*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*(Umry*Umry+Umrz*Umrz)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0)*8.0;
    H_0(3,5) = -Dy*(-(Umrx*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz)))/(Umrx*Umrx+Umry*Umry+Umrz*Umrz)+Umrx*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)+Umry*Umrz*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)+Umry*Umrz*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)*2.0+Umrx*(Umrz*Umrz)*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)*3.0+Umrx*(Umrz*Umrz)*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)-Umrx*(Umrz*Umrz)*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,5.0/2.0)*3.0-(Umrx*Umrx)*Umry*Umrz*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0)*8.0+(Umrx*Umrx)*Umry*Umrz*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)-(Umrx*Umrx)*Umry*Umrz*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,5.0/2.0)*5.0)-Dz*(-(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)/(Umrx*Umrx+Umry*Umry+Umrz*Umrz)+(Umrx*Umrx)*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)+(Umrz*Umrz)*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)+(Umrx*Umrx)*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)*2.0+(Umrz*Umrz)*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)*2.0-(Umrx*Umrx)*(Umrz*Umrz)*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0)*8.0+(Umrx*Umrx)*(Umrz*Umrz)*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)-(Umrx*Umrx)*(Umrz*Umrz)*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,5.0/2.0)*5.0-Umrx*Umry*Umrz*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)*3.0-Umrx*Umry*Umrz*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)+Umrx*Umry*Umrz*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,5.0/2.0)*3.0)+Dx*Umrx*Umrz*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)*2.0+Dx*Umrx*Umrz*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)*4.0+Dx*Umrx*Umrz*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*(Umry*Umry+Umrz*Umrz)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)-Dx*Umrx*Umrz*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*(Umry*Umry+Umrz*Umrz)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,5.0/2.0)*5.0-Dx*Umrx*Umrz*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*(Umry*Umry+Umrz*Umrz)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0)*8.0;
    H_0(4,3) = -Dz*((Umrx*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz)))/(Umrx*Umrx+Umry*Umry+Umrz*Umrz)-Umrx*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)+Umry*Umrz*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)+Umry*Umrz*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)*2.0-Umrx*(Umry*Umry)*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)*3.0-Umrx*(Umry*Umry)*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)+Umrx*(Umry*Umry)*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,5.0/2.0)*3.0-(Umrx*Umrx)*Umry*Umrz*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0)*8.0+(Umrx*Umrx)*Umry*Umrz*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)-(Umrx*Umrx)*Umry*Umrz*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,5.0/2.0)*5.0)-Dy*(-(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)/(Umrx*Umrx+Umry*Umry+Umrz*Umrz)+(Umrx*Umrx)*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)+(Umry*Umry)*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)+(Umrx*Umrx)*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)*2.0+(Umry*Umry)*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)*2.0-(Umrx*Umrx)*(Umry*Umry)*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0)*8.0+(Umrx*Umrx)*(Umry*Umry)*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)-(Umrx*Umrx)*(Umry*Umry)*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,5.0/2.0)*5.0+Umrx*Umry*Umrz*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)*3.0+Umrx*Umry*Umrz*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)-Umrx*Umry*Umrz*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,5.0/2.0)*3.0)+Dx*Umrx*Umry*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)*2.0+Dx*Umrx*Umry*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)*4.0+Dx*Umrx*Umry*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*(Umry*Umry+Umrz*Umrz)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)-Dx*Umrx*Umry*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*(Umry*Umry+Umrz*Umrz)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,5.0/2.0)*5.0-Dx*Umrx*Umry*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*(Umry*Umry+Umrz*Umrz)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0)*8.0;
    H_0(4,4) = -Dy*(-(Umrz*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz)))/(Umrx*Umrx+Umry*Umry+Umrz*Umrz)+Umrz*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)+Umrx*Umry*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)*3.0+Umrx*Umry*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)*6.0+Umrx*(Umry*Umry*Umry)*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)+(Umry*Umry)*Umrz*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)*3.0+(Umry*Umry)*Umrz*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)-Umrx*(Umry*Umry*Umry)*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,5.0/2.0)*5.0-(Umry*Umry)*Umrz*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,5.0/2.0)*3.0-Umrx*(Umry*Umry*Umry)*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0)*8.0)+Dz*((Umry*Umry*Umry)*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)*3.0+(Umry*Umry*Umry)*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)-(Umry*Umry*Umry)*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,5.0/2.0)*3.0-(Umry*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*3.0)/(Umrx*Umrx+Umry*Umry+Umrz*Umrz)+Umry*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)*3.0-Umrx*Umrz*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)-Umrx*Umrz*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)*2.0+Umrx*(Umry*Umry)*Umrz*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0)*8.0-Umrx*(Umry*Umry)*Umrz*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)+Umrx*(Umry*Umry)*Umrz*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,5.0/2.0)*5.0)-(Dx*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*2.0)/(Umrx*Umrx+Umry*Umry+Umrz*Umrz)+Dx*(Umry*Umry)*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)*4.0+Dx*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*(Umry*Umry+Umrz*Umrz)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)+Dx*(Umry*Umry)*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)*8.0+Dx*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*(Umry*Umry+Umrz*Umrz)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)*2.0+Dx*(Umry*Umry)*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*(Umry*Umry+Umrz*Umrz)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)-Dx*(Umry*Umry)*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*(Umry*Umry+Umrz*Umrz)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,5.0/2.0)*5.0-Dx*(Umry*Umry)*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*(Umry*Umry+Umrz*Umrz)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0)*8.0;
    H_0(4,5) = -Dy*(-(Umry*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz)))/(Umrx*Umrx+Umry*Umry+Umrz*Umrz)+Umry*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)+Umrx*Umrz*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)+Umrx*Umrz*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)*2.0+Umry*(Umrz*Umrz)*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)*3.0+Umry*(Umrz*Umrz)*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)-Umry*(Umrz*Umrz)*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,5.0/2.0)*3.0-Umrx*(Umry*Umry)*Umrz*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0)*8.0+Umrx*(Umry*Umry)*Umrz*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)-Umrx*(Umry*Umry)*Umrz*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,5.0/2.0)*5.0)-Dz*((Umrz*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz)))/(Umrx*Umrx+Umry*Umry+Umrz*Umrz)-Umrz*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)+Umrx*Umry*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)+Umrx*Umry*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)*2.0-(Umry*Umry)*Umrz*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)*3.0-(Umry*Umry)*Umrz*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)+(Umry*Umry)*Umrz*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,5.0/2.0)*3.0-Umrx*Umry*(Umrz*Umrz)*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0)*8.0+Umrx*Umry*(Umrz*Umrz)*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)-Umrx*Umry*(Umrz*Umrz)*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,5.0/2.0)*5.0)+Dx*Umry*Umrz*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)*4.0+Dx*Umry*Umrz*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)*8.0+Dx*Umry*Umrz*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*(Umry*Umry+Umrz*Umrz)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)-Dx*Umry*Umrz*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*(Umry*Umry+Umrz*Umrz)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,5.0/2.0)*5.0-Dx*Umry*Umrz*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*(Umry*Umry+Umrz*Umrz)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0)*8.0;
    H_0(5,3) = -Dy*(-(Umrx*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz)))/(Umrx*Umrx+Umry*Umry+Umrz*Umrz)+Umrx*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)+Umry*Umrz*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)+Umry*Umrz*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)*2.0+Umrx*(Umrz*Umrz)*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)*3.0+Umrx*(Umrz*Umrz)*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)-Umrx*(Umrz*Umrz)*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,5.0/2.0)*3.0-(Umrx*Umrx)*Umry*Umrz*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0)*8.0+(Umrx*Umrx)*Umry*Umrz*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)-(Umrx*Umrx)*Umry*Umrz*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,5.0/2.0)*5.0)-Dz*(-(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)/(Umrx*Umrx+Umry*Umry+Umrz*Umrz)+(Umrx*Umrx)*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)+(Umrz*Umrz)*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)+(Umrx*Umrx)*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)*2.0+(Umrz*Umrz)*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)*2.0-(Umrx*Umrx)*(Umrz*Umrz)*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0)*8.0+(Umrx*Umrx)*(Umrz*Umrz)*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)-(Umrx*Umrx)*(Umrz*Umrz)*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,5.0/2.0)*5.0-Umrx*Umry*Umrz*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)*3.0-Umrx*Umry*Umrz*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)+Umrx*Umry*Umrz*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,5.0/2.0)*3.0)+Dx*Umrx*Umrz*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)*2.0+Dx*Umrx*Umrz*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)*4.0+Dx*Umrx*Umrz*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*(Umry*Umry+Umrz*Umrz)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)-Dx*Umrx*Umrz*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*(Umry*Umry+Umrz*Umrz)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,5.0/2.0)*5.0-Dx*Umrx*Umrz*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*(Umry*Umry+Umrz*Umrz)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0)*8.0;
    H_0(5,4) = -Dy*(-(Umry*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz)))/(Umrx*Umrx+Umry*Umry+Umrz*Umrz)+Umry*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)+Umrx*Umrz*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)+Umrx*Umrz*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)*2.0+Umry*(Umrz*Umrz)*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)*3.0+Umry*(Umrz*Umrz)*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)-Umry*(Umrz*Umrz)*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,5.0/2.0)*3.0-Umrx*(Umry*Umry)*Umrz*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0)*8.0+Umrx*(Umry*Umry)*Umrz*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)-Umrx*(Umry*Umry)*Umrz*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,5.0/2.0)*5.0)-Dz*((Umrz*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz)))/(Umrx*Umrx+Umry*Umry+Umrz*Umrz)-Umrz*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)+Umrx*Umry*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)+Umrx*Umry*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)*2.0-(Umry*Umry)*Umrz*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)*3.0-(Umry*Umry)*Umrz*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)+(Umry*Umry)*Umrz*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,5.0/2.0)*3.0-Umrx*Umry*(Umrz*Umrz)*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0)*8.0+Umrx*Umry*(Umrz*Umrz)*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)-Umrx*Umry*(Umrz*Umrz)*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,5.0/2.0)*5.0)+Dx*Umry*Umrz*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)*4.0+Dx*Umry*Umrz*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)*8.0+Dx*Umry*Umrz*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*(Umry*Umry+Umrz*Umrz)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)-Dx*Umry*Umrz*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*(Umry*Umry+Umrz*Umrz)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,5.0/2.0)*5.0-Dx*Umry*Umrz*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*(Umry*Umry+Umrz*Umrz)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0)*8.0;
    H_0(5,5) = -Dy*((Umrz*Umrz*Umrz)*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)*3.0+(Umrz*Umrz*Umrz)*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)-(Umrz*Umrz*Umrz)*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,5.0/2.0)*3.0-(Umrz*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*3.0)/(Umrx*Umrx+Umry*Umry+Umrz*Umrz)+Umrz*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)*3.0+Umrx*Umry*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)+Umrx*Umry*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)*2.0-Umrx*Umry*(Umrz*Umrz)*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0)*8.0+Umrx*Umry*(Umrz*Umrz)*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)-Umrx*Umry*(Umrz*Umrz)*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,5.0/2.0)*5.0)-Dz*((Umry*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz)))/(Umrx*Umrx+Umry*Umry+Umrz*Umrz)-Umry*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)+Umrx*Umrz*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)*3.0+Umrx*Umrz*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)*6.0+Umrx*(Umrz*Umrz*Umrz)*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)-Umry*(Umrz*Umrz)*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)*3.0-Umry*(Umrz*Umrz)*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)-Umrx*(Umrz*Umrz*Umrz)*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,5.0/2.0)*5.0+Umry*(Umrz*Umrz)*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,5.0/2.0)*3.0-Umrx*(Umrz*Umrz*Umrz)*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0)*8.0)-(Dx*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*2.0)/(Umrx*Umrx+Umry*Umry+Umrz*Umrz)+Dx*(Umrz*Umrz)*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)*4.0+Dx*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*(Umry*Umry+Umrz*Umrz)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)+Dx*(Umrz*Umrz)*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)*8.0+Dx*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*(Umry*Umry+Umrz*Umrz)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)*2.0+Dx*(Umrz*Umrz)*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*(Umry*Umry+Umrz*Umrz)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)-Dx*(Umrz*Umrz)*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*(Umry*Umry+Umrz*Umrz)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,5.0/2.0)*5.0-Dx*(Umrz*Umrz)*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*(Umry*Umry+Umrz*Umrz)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0)*8.0;
    
    H_1(3,3) = -Dx*((Umrz*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz)))/(Umrx*Umrx+Umry*Umry+Umrz*Umrz)-Umrz*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)+Umrx*Umry*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)*3.0+Umrx*Umry*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)*6.0-(Umrx*Umrx)*Umrz*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)*3.0+(Umrx*Umrx*Umrx)*Umry*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)-(Umrx*Umrx)*Umrz*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)+(Umrx*Umrx)*Umrz*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,5.0/2.0)*3.0-(Umrx*Umrx*Umrx)*Umry*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,5.0/2.0)*5.0-(Umrx*Umrx*Umrx)*Umry*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0)*8.0)-Dz*((Umrx*Umrx*Umrx)*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)*3.0+(Umrx*Umrx*Umrx)*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)-(Umrx*Umrx*Umrx)*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,5.0/2.0)*3.0-(Umrx*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*3.0)/(Umrx*Umrx+Umry*Umry+Umrz*Umrz)+Umrx*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)*3.0+Umry*Umrz*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)+Umry*Umrz*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)*2.0-(Umrx*Umrx)*Umry*Umrz*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0)*8.0+(Umrx*Umrx)*Umry*Umrz*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)-(Umrx*Umrx)*Umry*Umrz*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,5.0/2.0)*5.0)-(Dy*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*2.0)/(Umrx*Umrx+Umry*Umry+Umrz*Umrz)+Dy*(Umrx*Umrx)*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)*4.0+Dy*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*(Umrx*Umrx+Umrz*Umrz)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)+Dy*(Umrx*Umrx)*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)*8.0+Dy*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*(Umrx*Umrx+Umrz*Umrz)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)*2.0+Dy*(Umrx*Umrx)*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*(Umrx*Umrx+Umrz*Umrz)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)-Dy*(Umrx*Umrx)*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*(Umrx*Umrx+Umrz*Umrz)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,5.0/2.0)*5.0-Dy*(Umrx*Umrx)*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*(Umrx*Umrx+Umrz*Umrz)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0)*8.0;
    H_1(3,4) = -Dz*(-(Umry*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz)))/(Umrx*Umrx+Umry*Umry+Umrz*Umrz)+Umry*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)+Umrx*Umrz*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)+Umrx*Umrz*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)*2.0+(Umrx*Umrx)*Umry*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)*3.0+(Umrx*Umrx)*Umry*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)-(Umrx*Umrx)*Umry*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,5.0/2.0)*3.0-Umrx*(Umry*Umry)*Umrz*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0)*8.0+Umrx*(Umry*Umry)*Umrz*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)-Umrx*(Umry*Umry)*Umrz*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,5.0/2.0)*5.0)-Dx*(-(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)/(Umrx*Umrx+Umry*Umry+Umrz*Umrz)+(Umrx*Umrx)*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)+(Umry*Umry)*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)+(Umrx*Umrx)*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)*2.0+(Umry*Umry)*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)*2.0-(Umrx*Umrx)*(Umry*Umry)*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0)*8.0+(Umrx*Umrx)*(Umry*Umry)*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)-(Umrx*Umrx)*(Umry*Umry)*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,5.0/2.0)*5.0-Umrx*Umry*Umrz*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)*3.0-Umrx*Umry*Umrz*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)+Umrx*Umry*Umrz*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,5.0/2.0)*3.0)+Dy*Umrx*Umry*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)*2.0+Dy*Umrx*Umry*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)*4.0+Dy*Umrx*Umry*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*(Umrx*Umrx+Umrz*Umrz)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)-Dy*Umrx*Umry*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*(Umrx*Umrx+Umrz*Umrz)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,5.0/2.0)*5.0-Dy*Umrx*Umry*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*(Umrx*Umrx+Umrz*Umrz)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0)*8.0;
    H_1(3,5) = -Dx*((Umrx*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz)))/(Umrx*Umrx+Umry*Umry+Umrz*Umrz)-Umrx*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)+Umry*Umrz*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)+Umry*Umrz*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)*2.0-Umrx*(Umrz*Umrz)*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)*3.0-Umrx*(Umrz*Umrz)*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)+Umrx*(Umrz*Umrz)*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,5.0/2.0)*3.0-(Umrx*Umrx)*Umry*Umrz*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0)*8.0+(Umrx*Umrx)*Umry*Umrz*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)-(Umrx*Umrx)*Umry*Umrz*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,5.0/2.0)*5.0)-Dz*(-(Umrz*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz)))/(Umrx*Umrx+Umry*Umry+Umrz*Umrz)+Umrz*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)+Umrx*Umry*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)+Umrx*Umry*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)*2.0+(Umrx*Umrx)*Umrz*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)*3.0+(Umrx*Umrx)*Umrz*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)-(Umrx*Umrx)*Umrz*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,5.0/2.0)*3.0-Umrx*Umry*(Umrz*Umrz)*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0)*8.0+Umrx*Umry*(Umrz*Umrz)*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)-Umrx*Umry*(Umrz*Umrz)*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,5.0/2.0)*5.0)+Dy*Umrx*Umrz*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)*4.0+Dy*Umrx*Umrz*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)*8.0+Dy*Umrx*Umrz*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*(Umrx*Umrx+Umrz*Umrz)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)-Dy*Umrx*Umrz*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*(Umrx*Umrx+Umrz*Umrz)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,5.0/2.0)*5.0-Dy*Umrx*Umrz*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*(Umrx*Umrx+Umrz*Umrz)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0)*8.0;
    H_1(4,3) = -Dz*(-(Umry*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz)))/(Umrx*Umrx+Umry*Umry+Umrz*Umrz)+Umry*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)+Umrx*Umrz*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)+Umrx*Umrz*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)*2.0+(Umrx*Umrx)*Umry*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)*3.0+(Umrx*Umrx)*Umry*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)-(Umrx*Umrx)*Umry*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,5.0/2.0)*3.0-Umrx*(Umry*Umry)*Umrz*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0)*8.0+Umrx*(Umry*Umry)*Umrz*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)-Umrx*(Umry*Umry)*Umrz*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,5.0/2.0)*5.0)-Dx*(-(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)/(Umrx*Umrx+Umry*Umry+Umrz*Umrz)+(Umrx*Umrx)*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)+(Umry*Umry)*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)+(Umrx*Umrx)*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)*2.0+(Umry*Umry)*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)*2.0-(Umrx*Umrx)*(Umry*Umry)*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0)*8.0+(Umrx*Umrx)*(Umry*Umry)*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)-(Umrx*Umrx)*(Umry*Umry)*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,5.0/2.0)*5.0-Umrx*Umry*Umrz*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)*3.0-Umrx*Umry*Umrz*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)+Umrx*Umry*Umrz*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,5.0/2.0)*3.0)+Dy*Umrx*Umry*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)*2.0+Dy*Umrx*Umry*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)*4.0+Dy*Umrx*Umry*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*(Umrx*Umrx+Umrz*Umrz)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)-Dy*Umrx*Umry*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*(Umrx*Umrx+Umrz*Umrz)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,5.0/2.0)*5.0-Dy*Umrx*Umry*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*(Umrx*Umrx+Umrz*Umrz)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0)*8.0;
    H_1(4,4) = -Dx*((Umrz*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz)))/(Umrx*Umrx+Umry*Umry+Umrz*Umrz)-Umrz*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)+Umrx*Umry*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)*3.0+Umrx*Umry*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)*6.0+Umrx*(Umry*Umry*Umry)*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)-(Umry*Umry)*Umrz*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)*3.0-(Umry*Umry)*Umrz*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)-Umrx*(Umry*Umry*Umry)*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,5.0/2.0)*5.0+(Umry*Umry)*Umrz*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,5.0/2.0)*3.0-Umrx*(Umry*Umry*Umry)*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0)*8.0)-Dz*(-(Umrx*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz)))/(Umrx*Umrx+Umry*Umry+Umrz*Umrz)+Umrx*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)+Umry*Umrz*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)*3.0+Umry*Umrz*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)*6.0+Umrx*(Umry*Umry)*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)*3.0+(Umry*Umry*Umry)*Umrz*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)+Umrx*(Umry*Umry)*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)-Umrx*(Umry*Umry)*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,5.0/2.0)*3.0-(Umry*Umry*Umry)*Umrz*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,5.0/2.0)*5.0-(Umry*Umry*Umry)*Umrz*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0)*8.0)+Dy*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*(Umrx*Umrx+Umrz*Umrz)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)+Dy*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*(Umrx*Umrx+Umrz*Umrz)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)*2.0+Dy*(Umry*Umry)*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*(Umrx*Umrx+Umrz*Umrz)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)-Dy*(Umry*Umry)*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*(Umrx*Umrx+Umrz*Umrz)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,5.0/2.0)*5.0-Dy*(Umry*Umry)*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*(Umrx*Umrx+Umrz*Umrz)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0)*8.0;
    H_1(4,5) = -Dx*((Umry*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz)))/(Umrx*Umrx+Umry*Umry+Umrz*Umrz)-Umry*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)+Umrx*Umrz*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)+Umrx*Umrz*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)*2.0-Umry*(Umrz*Umrz)*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)*3.0-Umry*(Umrz*Umrz)*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)+Umry*(Umrz*Umrz)*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,5.0/2.0)*3.0-Umrx*(Umry*Umry)*Umrz*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0)*8.0+Umrx*(Umry*Umry)*Umrz*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)-Umrx*(Umry*Umry)*Umrz*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,5.0/2.0)*5.0)-Dz*(-(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)/(Umrx*Umrx+Umry*Umry+Umrz*Umrz)+(Umry*Umry)*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)+(Umrz*Umrz)*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)+(Umry*Umry)*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)*2.0+(Umrz*Umrz)*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)*2.0-(Umry*Umry)*(Umrz*Umrz)*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0)*8.0+(Umry*Umry)*(Umrz*Umrz)*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)-(Umry*Umry)*(Umrz*Umrz)*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,5.0/2.0)*5.0+Umrx*Umry*Umrz*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)*3.0+Umrx*Umry*Umrz*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)-Umrx*Umry*Umrz*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,5.0/2.0)*3.0)+Dy*Umry*Umrz*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)*2.0+Dy*Umry*Umrz*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)*4.0+Dy*Umry*Umrz*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*(Umrx*Umrx+Umrz*Umrz)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)-Dy*Umry*Umrz*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*(Umrx*Umrx+Umrz*Umrz)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,5.0/2.0)*5.0-Dy*Umry*Umrz*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*(Umrx*Umrx+Umrz*Umrz)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0)*8.0;
    H_1(5,3) = -Dx*((Umrx*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz)))/(Umrx*Umrx+Umry*Umry+Umrz*Umrz)-Umrx*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)+Umry*Umrz*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)+Umry*Umrz*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)*2.0-Umrx*(Umrz*Umrz)*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)*3.0-Umrx*(Umrz*Umrz)*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)+Umrx*(Umrz*Umrz)*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,5.0/2.0)*3.0-(Umrx*Umrx)*Umry*Umrz*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0)*8.0+(Umrx*Umrx)*Umry*Umrz*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)-(Umrx*Umrx)*Umry*Umrz*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,5.0/2.0)*5.0)-Dz*(-(Umrz*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz)))/(Umrx*Umrx+Umry*Umry+Umrz*Umrz)+Umrz*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)+Umrx*Umry*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)+Umrx*Umry*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)*2.0+(Umrx*Umrx)*Umrz*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)*3.0+(Umrx*Umrx)*Umrz*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)-(Umrx*Umrx)*Umrz*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,5.0/2.0)*3.0-Umrx*Umry*(Umrz*Umrz)*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0)*8.0+Umrx*Umry*(Umrz*Umrz)*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)-Umrx*Umry*(Umrz*Umrz)*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,5.0/2.0)*5.0)+Dy*Umrx*Umrz*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)*4.0+Dy*Umrx*Umrz*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)*8.0+Dy*Umrx*Umrz*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*(Umrx*Umrx+Umrz*Umrz)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)-Dy*Umrx*Umrz*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*(Umrx*Umrx+Umrz*Umrz)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,5.0/2.0)*5.0-Dy*Umrx*Umrz*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*(Umrx*Umrx+Umrz*Umrz)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0)*8.0;
    H_1(5,4) = -Dx*((Umry*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz)))/(Umrx*Umrx+Umry*Umry+Umrz*Umrz)-Umry*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)+Umrx*Umrz*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)+Umrx*Umrz*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)*2.0-Umry*(Umrz*Umrz)*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)*3.0-Umry*(Umrz*Umrz)*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)+Umry*(Umrz*Umrz)*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,5.0/2.0)*3.0-Umrx*(Umry*Umry)*Umrz*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0)*8.0+Umrx*(Umry*Umry)*Umrz*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)-Umrx*(Umry*Umry)*Umrz*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,5.0/2.0)*5.0)-Dz*(-(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)/(Umrx*Umrx+Umry*Umry+Umrz*Umrz)+(Umry*Umry)*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)+(Umrz*Umrz)*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)+(Umry*Umry)*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)*2.0+(Umrz*Umrz)*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)*2.0-(Umry*Umry)*(Umrz*Umrz)*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0)*8.0+(Umry*Umry)*(Umrz*Umrz)*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)-(Umry*Umry)*(Umrz*Umrz)*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,5.0/2.0)*5.0+Umrx*Umry*Umrz*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)*3.0+Umrx*Umry*Umrz*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)-Umrx*Umry*Umrz*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,5.0/2.0)*3.0)+Dy*Umry*Umrz*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)*2.0+Dy*Umry*Umrz*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)*4.0+Dy*Umry*Umrz*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*(Umrx*Umrx+Umrz*Umrz)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)-Dy*Umry*Umrz*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*(Umrx*Umrx+Umrz*Umrz)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,5.0/2.0)*5.0-Dy*Umry*Umrz*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*(Umrx*Umrx+Umrz*Umrz)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0)*8.0;
    H_1(5,5) = Dx*((Umrz*Umrz*Umrz)*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)*3.0+(Umrz*Umrz*Umrz)*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)-(Umrz*Umrz*Umrz)*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,5.0/2.0)*3.0-(Umrz*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*3.0)/(Umrx*Umrx+Umry*Umry+Umrz*Umrz)+Umrz*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)*3.0-Umrx*Umry*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)-Umrx*Umry*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)*2.0+Umrx*Umry*(Umrz*Umrz)*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0)*8.0-Umrx*Umry*(Umrz*Umrz)*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)+Umrx*Umry*(Umrz*Umrz)*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,5.0/2.0)*5.0)-Dz*(-(Umrx*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz)))/(Umrx*Umrx+Umry*Umry+Umrz*Umrz)+Umrx*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)+Umry*Umrz*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)*3.0+Umry*Umrz*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)*6.0+Umrx*(Umrz*Umrz)*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)*3.0+Umry*(Umrz*Umrz*Umrz)*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)+Umrx*(Umrz*Umrz)*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)-Umrx*(Umrz*Umrz)*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,5.0/2.0)*3.0-Umry*(Umrz*Umrz*Umrz)*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,5.0/2.0)*5.0-Umry*(Umrz*Umrz*Umrz)*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0)*8.0)-(Dy*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*2.0)/(Umrx*Umrx+Umry*Umry+Umrz*Umrz)+Dy*(Umrz*Umrz)*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)*4.0+Dy*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*(Umrx*Umrx+Umrz*Umrz)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)+Dy*(Umrz*Umrz)*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)*8.0+Dy*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*(Umrx*Umrx+Umrz*Umrz)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)*2.0+Dy*(Umrz*Umrz)*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*(Umrx*Umrx+Umrz*Umrz)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)-Dy*(Umrz*Umrz)*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*(Umrx*Umrx+Umrz*Umrz)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,5.0/2.0)*5.0-Dy*(Umrz*Umrz)*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*(Umrx*Umrx+Umrz*Umrz)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0)*8.0;
    
    H_2(3,3) = -Dx*(-(Umry*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz)))/(Umrx*Umrx+Umry*Umry+Umrz*Umrz)+Umry*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)+Umrx*Umrz*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)*3.0+Umrx*Umrz*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)*6.0+(Umrx*Umrx)*Umry*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)*3.0+(Umrx*Umrx*Umrx)*Umrz*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)+(Umrx*Umrx)*Umry*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)-(Umrx*Umrx)*Umry*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,5.0/2.0)*3.0-(Umrx*Umrx*Umrx)*Umrz*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,5.0/2.0)*5.0-(Umrx*Umrx*Umrx)*Umrz*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0)*8.0)+Dy*((Umrx*Umrx*Umrx)*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)*3.0+(Umrx*Umrx*Umrx)*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)-(Umrx*Umrx*Umrx)*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,5.0/2.0)*3.0-(Umrx*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*3.0)/(Umrx*Umrx+Umry*Umry+Umrz*Umrz)+Umrx*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)*3.0-Umry*Umrz*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)-Umry*Umrz*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)*2.0+(Umrx*Umrx)*Umry*Umrz*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0)*8.0-(Umrx*Umrx)*Umry*Umrz*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)+(Umrx*Umrx)*Umry*Umrz*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,5.0/2.0)*5.0)-(Dz*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*2.0)/(Umrx*Umrx+Umry*Umry+Umrz*Umrz)+Dz*(Umrx*Umrx)*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)*4.0+Dz*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*(Umrx*Umrx+Umry*Umry)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)+Dz*(Umrx*Umrx)*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)*8.0+Dz*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*(Umrx*Umrx+Umry*Umry)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)*2.0+Dz*(Umrx*Umrx)*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*(Umrx*Umrx+Umry*Umry)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)-Dz*(Umrx*Umrx)*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*(Umrx*Umrx+Umry*Umry)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,5.0/2.0)*5.0-Dz*(Umrx*Umrx)*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*(Umrx*Umrx+Umry*Umry)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0)*8.0;
    H_2(3,4) = -Dx*(-(Umrx*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz)))/(Umrx*Umrx+Umry*Umry+Umrz*Umrz)+Umrx*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)+Umry*Umrz*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)+Umry*Umrz*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)*2.0+Umrx*(Umry*Umry)*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)*3.0+Umrx*(Umry*Umry)*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)-Umrx*(Umry*Umry)*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,5.0/2.0)*3.0-(Umrx*Umrx)*Umry*Umrz*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0)*8.0+(Umrx*Umrx)*Umry*Umrz*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)-(Umrx*Umrx)*Umry*Umrz*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,5.0/2.0)*5.0)-Dy*((Umry*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz)))/(Umrx*Umrx+Umry*Umry+Umrz*Umrz)-Umry*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)+Umrx*Umrz*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)+Umrx*Umrz*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)*2.0-(Umrx*Umrx)*Umry*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)*3.0-(Umrx*Umrx)*Umry*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)+(Umrx*Umrx)*Umry*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,5.0/2.0)*3.0-Umrx*(Umry*Umry)*Umrz*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0)*8.0+Umrx*(Umry*Umry)*Umrz*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)-Umrx*(Umry*Umry)*Umrz*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,5.0/2.0)*5.0)+Dz*Umrx*Umry*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)*4.0+Dz*Umrx*Umry*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)*8.0+Dz*Umrx*Umry*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*(Umrx*Umrx+Umry*Umry)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)-Dz*Umrx*Umry*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*(Umrx*Umrx+Umry*Umry)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,5.0/2.0)*5.0-Dz*Umrx*Umry*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*(Umrx*Umrx+Umry*Umry)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0)*8.0;
    H_2(3,5) = -Dy*((Umrz*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz)))/(Umrx*Umrx+Umry*Umry+Umrz*Umrz)-Umrz*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)+Umrx*Umry*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)+Umrx*Umry*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)*2.0-(Umrx*Umrx)*Umrz*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)*3.0-(Umrx*Umrx)*Umrz*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)+(Umrx*Umrx)*Umrz*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,5.0/2.0)*3.0-Umrx*Umry*(Umrz*Umrz)*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0)*8.0+Umrx*Umry*(Umrz*Umrz)*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)-Umrx*Umry*(Umrz*Umrz)*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,5.0/2.0)*5.0)-Dx*(-(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)/(Umrx*Umrx+Umry*Umry+Umrz*Umrz)+(Umrx*Umrx)*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)+(Umrz*Umrz)*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)+(Umrx*Umrx)*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)*2.0+(Umrz*Umrz)*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)*2.0-(Umrx*Umrx)*(Umrz*Umrz)*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0)*8.0+(Umrx*Umrx)*(Umrz*Umrz)*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)-(Umrx*Umrx)*(Umrz*Umrz)*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,5.0/2.0)*5.0+Umrx*Umry*Umrz*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)*3.0+Umrx*Umry*Umrz*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)-Umrx*Umry*Umrz*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,5.0/2.0)*3.0)+Dz*Umrx*Umrz*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)*2.0+Dz*Umrx*Umrz*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)*4.0+Dz*Umrx*Umrz*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*(Umrx*Umrx+Umry*Umry)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)-Dz*Umrx*Umrz*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*(Umrx*Umrx+Umry*Umry)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,5.0/2.0)*5.0-Dz*Umrx*Umrz*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*(Umrx*Umrx+Umry*Umry)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0)*8.0;
    H_2(4,3) = -Dx*(-(Umrx*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz)))/(Umrx*Umrx+Umry*Umry+Umrz*Umrz)+Umrx*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)+Umry*Umrz*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)+Umry*Umrz*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)*2.0+Umrx*(Umry*Umry)*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)*3.0+Umrx*(Umry*Umry)*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)-Umrx*(Umry*Umry)*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,5.0/2.0)*3.0-(Umrx*Umrx)*Umry*Umrz*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0)*8.0+(Umrx*Umrx)*Umry*Umrz*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)-(Umrx*Umrx)*Umry*Umrz*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,5.0/2.0)*5.0)-Dy*((Umry*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz)))/(Umrx*Umrx+Umry*Umry+Umrz*Umrz)-Umry*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)+Umrx*Umrz*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)+Umrx*Umrz*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)*2.0-(Umrx*Umrx)*Umry*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)*3.0-(Umrx*Umrx)*Umry*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)+(Umrx*Umrx)*Umry*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,5.0/2.0)*3.0-Umrx*(Umry*Umry)*Umrz*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0)*8.0+Umrx*(Umry*Umry)*Umrz*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)-Umrx*(Umry*Umry)*Umrz*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,5.0/2.0)*5.0)+Dz*Umrx*Umry*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)*4.0+Dz*Umrx*Umry*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)*8.0+Dz*Umrx*Umry*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*(Umrx*Umrx+Umry*Umry)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)-Dz*Umrx*Umry*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*(Umrx*Umrx+Umry*Umry)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,5.0/2.0)*5.0-Dz*Umrx*Umry*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*(Umrx*Umrx+Umry*Umry)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0)*8.0;
    H_2(4,4) = -Dx*((Umry*Umry*Umry)*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)*3.0+(Umry*Umry*Umry)*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)-(Umry*Umry*Umry)*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,5.0/2.0)*3.0-(Umry*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*3.0)/(Umrx*Umrx+Umry*Umry+Umrz*Umrz)+Umry*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)*3.0+Umrx*Umrz*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)+Umrx*Umrz*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)*2.0-Umrx*(Umry*Umry)*Umrz*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0)*8.0+Umrx*(Umry*Umry)*Umrz*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)-Umrx*(Umry*Umry)*Umrz*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,5.0/2.0)*5.0)-Dy*((Umrx*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz)))/(Umrx*Umrx+Umry*Umry+Umrz*Umrz)-Umrx*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)+Umry*Umrz*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)*3.0+Umry*Umrz*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)*6.0-Umrx*(Umry*Umry)*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)*3.0+(Umry*Umry*Umry)*Umrz*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)-Umrx*(Umry*Umry)*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)+Umrx*(Umry*Umry)*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,5.0/2.0)*3.0-(Umry*Umry*Umry)*Umrz*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,5.0/2.0)*5.0-(Umry*Umry*Umry)*Umrz*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0)*8.0)-(Dz*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*2.0)/(Umrx*Umrx+Umry*Umry+Umrz*Umrz)+Dz*(Umry*Umry)*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)*4.0+Dz*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*(Umrx*Umrx+Umry*Umry)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)+Dz*(Umry*Umry)*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)*8.0+Dz*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*(Umrx*Umrx+Umry*Umry)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)*2.0+Dz*(Umry*Umry)*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*(Umrx*Umrx+Umry*Umry)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)-Dz*(Umry*Umry)*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*(Umrx*Umrx+Umry*Umry)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,5.0/2.0)*5.0-Dz*(Umry*Umry)*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*(Umrx*Umrx+Umry*Umry)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0)*8.0;
    H_2(4,5) = -Dx*(-(Umrz*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz)))/(Umrx*Umrx+Umry*Umry+Umrz*Umrz)+Umrz*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)+Umrx*Umry*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)+Umrx*Umry*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)*2.0+(Umry*Umry)*Umrz*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)*3.0+(Umry*Umry)*Umrz*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)-(Umry*Umry)*Umrz*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,5.0/2.0)*3.0-Umrx*Umry*(Umrz*Umrz)*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0)*8.0+Umrx*Umry*(Umrz*Umrz)*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)-Umrx*Umry*(Umrz*Umrz)*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,5.0/2.0)*5.0)-Dy*(-(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)/(Umrx*Umrx+Umry*Umry+Umrz*Umrz)+(Umry*Umry)*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)+(Umrz*Umrz)*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)+(Umry*Umry)*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)*2.0+(Umrz*Umrz)*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)*2.0-(Umry*Umry)*(Umrz*Umrz)*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0)*8.0+(Umry*Umry)*(Umrz*Umrz)*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)-(Umry*Umry)*(Umrz*Umrz)*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,5.0/2.0)*5.0-Umrx*Umry*Umrz*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)*3.0-Umrx*Umry*Umrz*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)+Umrx*Umry*Umrz*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,5.0/2.0)*3.0)+Dz*Umry*Umrz*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)*2.0+Dz*Umry*Umrz*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)*4.0+Dz*Umry*Umrz*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*(Umrx*Umrx+Umry*Umry)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)-Dz*Umry*Umrz*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*(Umrx*Umrx+Umry*Umry)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,5.0/2.0)*5.0-Dz*Umry*Umrz*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*(Umrx*Umrx+Umry*Umry)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0)*8.0;
    H_2(5,3) = -Dy*((Umrz*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz)))/(Umrx*Umrx+Umry*Umry+Umrz*Umrz)-Umrz*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)+Umrx*Umry*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)+Umrx*Umry*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)*2.0-(Umrx*Umrx)*Umrz*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)*3.0-(Umrx*Umrx)*Umrz*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)+(Umrx*Umrx)*Umrz*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,5.0/2.0)*3.0-Umrx*Umry*(Umrz*Umrz)*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0)*8.0+Umrx*Umry*(Umrz*Umrz)*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)-Umrx*Umry*(Umrz*Umrz)*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,5.0/2.0)*5.0)-Dx*(-(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)/(Umrx*Umrx+Umry*Umry+Umrz*Umrz)+(Umrx*Umrx)*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)+(Umrz*Umrz)*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)+(Umrx*Umrx)*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)*2.0+(Umrz*Umrz)*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)*2.0-(Umrx*Umrx)*(Umrz*Umrz)*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0)*8.0+(Umrx*Umrx)*(Umrz*Umrz)*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)-(Umrx*Umrx)*(Umrz*Umrz)*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,5.0/2.0)*5.0+Umrx*Umry*Umrz*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)*3.0+Umrx*Umry*Umrz*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)-Umrx*Umry*Umrz*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,5.0/2.0)*3.0)+Dz*Umrx*Umrz*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)*2.0+Dz*Umrx*Umrz*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)*4.0+Dz*Umrx*Umrz*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*(Umrx*Umrx+Umry*Umry)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)-Dz*Umrx*Umrz*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*(Umrx*Umrx+Umry*Umry)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,5.0/2.0)*5.0-Dz*Umrx*Umrz*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*(Umrx*Umrx+Umry*Umry)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0)*8.0;
    H_2(5,4) = -Dx*(-(Umrz*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz)))/(Umrx*Umrx+Umry*Umry+Umrz*Umrz)+Umrz*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)+Umrx*Umry*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)+Umrx*Umry*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)*2.0+(Umry*Umry)*Umrz*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)*3.0+(Umry*Umry)*Umrz*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)-(Umry*Umry)*Umrz*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,5.0/2.0)*3.0-Umrx*Umry*(Umrz*Umrz)*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0)*8.0+Umrx*Umry*(Umrz*Umrz)*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)-Umrx*Umry*(Umrz*Umrz)*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,5.0/2.0)*5.0)-Dy*(-(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)/(Umrx*Umrx+Umry*Umry+Umrz*Umrz)+(Umry*Umry)*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)+(Umrz*Umrz)*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)+(Umry*Umry)*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)*2.0+(Umrz*Umrz)*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)*2.0-(Umry*Umry)*(Umrz*Umrz)*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0)*8.0+(Umry*Umry)*(Umrz*Umrz)*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)-(Umry*Umry)*(Umrz*Umrz)*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,5.0/2.0)*5.0-Umrx*Umry*Umrz*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)*3.0-Umrx*Umry*Umrz*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)+Umrx*Umry*Umrz*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,5.0/2.0)*3.0)+Dz*Umry*Umrz*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)*2.0+Dz*Umry*Umrz*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)*4.0+Dz*Umry*Umrz*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*(Umrx*Umrx+Umry*Umry)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)-Dz*Umry*Umrz*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*(Umrx*Umrx+Umry*Umry)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,5.0/2.0)*5.0-Dz*Umry*Umrz*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*(Umrx*Umrx+Umry*Umry)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0)*8.0;
    H_2(5,5) = -Dx*(-(Umry*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz)))/(Umrx*Umrx+Umry*Umry+Umrz*Umrz)+Umry*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)+Umrx*Umrz*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)*3.0+Umrx*Umrz*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)*6.0+Umrx*(Umrz*Umrz*Umrz)*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)+Umry*(Umrz*Umrz)*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)*3.0+Umry*(Umrz*Umrz)*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)-Umrx*(Umrz*Umrz*Umrz)*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,5.0/2.0)*5.0-Umry*(Umrz*Umrz)*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,5.0/2.0)*3.0-Umrx*(Umrz*Umrz*Umrz)*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0)*8.0)-Dy*((Umrx*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz)))/(Umrx*Umrx+Umry*Umry+Umrz*Umrz)-Umrx*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)+Umry*Umrz*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)*3.0+Umry*Umrz*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)*6.0-Umrx*(Umrz*Umrz)*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)*3.0+Umry*(Umrz*Umrz*Umrz)*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)-Umrx*(Umrz*Umrz)*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)+Umrx*(Umrz*Umrz)*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,5.0/2.0)*3.0-Umry*(Umrz*Umrz*Umrz)*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,5.0/2.0)*5.0-Umry*(Umrz*Umrz*Umrz)*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0)*8.0)+Dz*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*(Umrx*Umrx+Umry*Umry)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0/2.0)+Dz*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*(Umrx*Umrx+Umry*Umry)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)*2.0+Dz*(Umrz*Umrz)*cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*(Umrx*Umrx+Umry*Umry)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,2.0)-Dz*(Umrz*Umrz)*sin(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))*(Umrx*Umrx+Umry*Umry)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,5.0/2.0)*5.0-Dz*(Umrz*Umrz)*(cos(sqrt(Umrx*Umrx+Umry*Umry+Umrz*Umrz))-1.0)*(Umrx*Umrx+Umry*Umry)*1.0/pow(Umrx*Umrx+Umry*Umry+Umrz*Umrz,3.0)*8.0;
    //std::cout <<"H_0 = \n"<< H_0 <<'\n' <<std::endl;
    //std::cout <<"H_1 = \n"<< H_1 <<'\n' <<std::endl;
    //std::cout <<"H_2 = \n"<< H_2 <<'\n' <<std::endl;
}

CRBE2::~CRBE2(void) {
};


